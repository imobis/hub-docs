<!DOCTYPE html>
<html>
  <head>
    <title>title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <div id="content"></div>

    <script src="https://api.apiary.io/seeds/embed.js"></script>
    <script>
        var embed = new Apiary.Embed({
          preferences: {
            console: false
          }
            apiBlueprint: "FORMAT: 1A\nHOST: https://api.hub.imobis.ru/v4/\n\n# Imobis Hub API\n\nHub API для отправки сообщений различными каналами\n\n**Точка подключения:** https://api.hub.imobis.ru/v4/\n\n**Формат данных:** JSON\n\n**Кодировка:** UTF-8\n\n### Заголовки\n\nAuthorization: Token xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\n\nContent-Type: application/json\n\n\n## Отправка сообщения [/message]\n\n### Отправка SMS [POST /message/sendSMS]\n\n+ Request (application/json)\n\n    + Headers\n            \n            Authorization: Token xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\n\n    + Attributes\n\n        + sender: imobis.ru (string, required) - Имя отправителя\n        + phone: 70000000000 (string, required) - Номер абонента\n        + text: Текст (string, required) - Текст сообщения\n        + ttl: 172800 (number) - Время жизни сообщения в секундах (от 60 до 172800)\n        + custom_id: 123 (string) - Пользовательский идентификатор сообщения\n        + report: https://imobis.ru (string) - URL для получения статусов\n\n+ Response 200 (application/json)\n\n        {\n            \"result\": \"success\",\n            \"id\": \"12345678901234567890\"\n        }\n\n+ Response 500 (application/json)\n\n        {\n            \"result\": \"error\",\n            \"error\": \"Access denied\"\n        }\n\n### Отправка Viber [POST /message/sendViber]\n\n+ Request (application/json)\n\n    + Headers\n            \n            Authorization: Token xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\n\n    + Attributes (object)\n\n        + sender: imobis (string, required) - Имя отправителя\n        + phone: 70000000000 (string, required) - Номер абонента\n        + text: Текст (string) - Текст сообщения\n        + image: `https://imobis.ru/wp-content/themes/imobis/icons/logo.png` (string) - URL картинка (рекомендуется 400x400, не более 1 МБ)\n        + action (object) \n            + title: Кнопка (string) - Надпись на кнопке\n            + url: string (string) - URL перехода для кнопки\n        + ttl: 86400 (number) - Время жизни сообщения в секундах (от 60 до 86400)\n        + custom_id: 123 (string) - Пользовательский идентификатор сообщения\n        + report: https://imobis.ru (string) - URL для получения статусов\n        + reply: https://imobis.ru (string) - URL для получения ответов\n        \n\n+ Response 200 (application/json)\n\n        {\n            \"result\": \"success\",\n            \"id\": \"12345678901234567890\"\n        }\n\n+ Response 500 (application/json)\n\n        {\n            \"result\": \"error\",\n            \"error\": \"Access denied\"\n        }\n\n### Отправка ВК [POST /message/sendVK]\n\n+ Request (application/json)\n\n    + Headers\n            \n            Authorization: Token xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\n\n    + Attributes (object)\n\n        + group: 5965316 (number, required) - Идентификатор группы ВК\n        + phone: 70000000000 (string, required) - Номер абонента\n        + text: Текст (string) - Текст сообщения\n        + ttl: 86400 (number) - Время жизни сообщения в секундах (от 60 до 86400)\n        + custom_id: 123 (string) - Пользовательский идентификатор сообщения\n        + report: https://imobis.ru (string) - URL для получения статусов\n        + reply: https://imobis.ru (string) - URL для получения ответов\n        \n\n+ Response 200 (application/json)\n\n        {\n            \"result\": \"success\",\n            \"id\": \"12345678901234567890\"\n        }\n\n+ Response 500 (application/json)\n\n        {\n            \"result\": \"error\",\n            \"error\": \"Access denied\"\n        }\n\n### Отправка гибридного сообщения [POST /message/send]\n\n+ Request (application/json)\n\n    + Headers\n            \n            Authorization: Token xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\n\n    + Attributes (object)\n\n        + custom_id: 123 (string) - Пользовательский идентификатор сообщения\n        + report: https://imobis.ru (string) - URL для получения статусов\n        + reply: https://imobis.ru (string) - URL для получения ответов\n        + route (array) - Порядок отправки\n            + (object)\n                + channel: vk (string, required) - Канал отправки\n                + group: 5965316 (number, required) - Идентификатор группы ВК\n                + phone: 70000000000 (string, required) - Номер абонента\n                + text: Текст (string) - Текст сообщения\n                + ttl: 86400 (number) - Время жизни сообщения в секундах (от 60 до 86400)\n            + (object)\n                + channel: viber (string, required) - Канал отправки\n                + sender: imobis (string, required) - Имя отправителя\n                + phone: 70000000000 (string, required) - Номер абонента\n                + text: Текст (string) - Текст сообщения\n                + image: `https://imobis.ru/wp-content/themes/imobis/icons/logo.png` (string) - URL картинка (рекомендуется 400x400, не более 1 МБ)\n                + action (object) \n                    + title: Кнопка (string) - Надпись на кнопке\n                    + url: string (string) - URL перехода для кнопки\n                + ttl: 86400 (number) - Время жизни сообщения в секундах (от 60 до 86400)\n            + (object)\n                + channel: sms (string, required) - Канал отправки\n                + sender: imobis.ru (string, required) - Имя отправителя\n                + phone: 70000000000 (string, required) - Номер абонента\n                + text: Текст (string, required) - Текст сообщения\n                + ttl: 172800 (number) - Время жизни сообщения в секундах (от 60 до 172800)\n\n+ Response 200 (application/json)\n\n        {\n            \"result\": \"success\",\n            \"id\": \"12345678901234567890\"\n        }\n\n+ Response 500 (application/json)\n\n        {\n            \"result\": \"error\",\n            \"error\": \"Access denied\"\n        }\n\n## Формат ответных запросов [/]\n\n### Статус сообщения [POST /report]\n\n#### Описание статусов\n\n***\n\n##### Viber/SMS\n| Статус      | Описание |\n|-------------|----------|\n| sent        | Сообщение передано оператору, окончательный статус не был получен\n| unknown     | Статус неизвестен\n| rejected    | Сообщение отклонено оператором\n| undelivered | Сообщение не может быть доставлено\n| expired     | Время на доставку сообщения истекло\n| delivered   | Доставлено\n| read        | Сообщение было прочитано\n\n##### ВК\n| Статус          | Описание |\n|-----------------|----------|\n| delivered       | Доставлено\n| unsupported     | Уведомление не может быть доставлено, так как данного получателя не существует в системе\n| expired         | Уведомление не доставлено, так как вышло время ttl на доставку до устройства пользователя\n| ratelimit       | Слишком много отправленных сообщений\n| read            | Сообщение было прочитано только что. Данный статус не придет, если сообщение было прочитано после истечения ttl + 24 часа (это не значит, что сообщение будет удалено, просто мы не пришлем статус прочитанности)\n| blocked_by_user | Пользователь запретил прием сообщений от данного отправителя\n\n+ Request (application/json)\n    \n    ## Описание статуса error\n    **Описаны основные варианты, список может изменяться и дополняться.**\n    **При подключении сторонних API, передается описание ошибок, полученное от них.**\n\n    | Ошибка                                     |      Описание                                                 |\n    |--------------------------------------------|---------------------------------------------------------------|\n    | Not found channel settings                 | Настройки канал не найдены                                    |\n    | The channel is not allowed                 | Отправка по данному каналу запрещена                          |\n    | The text is not matched existing templates | Текст сообщения не соответствует шаблону                      |\n    | No params                                  | Не указаны параметры                                          |\n    | No field \"\\<field name\\>\"                  | Отсутствует обязательное поле \"<название поля>\"               |\n    | Text or image or action must be specified  | Отсутствует текст, картинка или кнопка (только Viber)         |\n    | Incorrect content combination              | Неверная комбинация содержимого (только Viber)                |\n    | Action title and URL must be specified     | Должны быть указаны заголовок и URL для кнопки (только Viber) |\n    | No phone or user                           | Отсутствует номер абонента или телефон (только VK)            |\n    | No text or tmpl                            | Отсутствует текст или шаблон (только VK)     \n\n    + Attributes (object)\n    \n        + id: 12345678901234567890 (string, required) - Идентификатор сообщения\n        + custom_id: 123 (string) - Пользовательский идентификатор сообщения\n        + status: delivered (string, required) - Статус сообщения\n        + channel: sms (string, required) - Канал\n        + error: No params (string) - Описание статуса error                 |\n            \n+ Response 200\n\n### Ответ абонента [POST /reply]\n\n+ Request (application/json)\n\n    + Attributes (object)\n        \n        + source: 12345678901234567890 (string, required) - Идентификатор сообщения, по которому поступил ответ\n        + custom_id: 123 (string) - Пользовательский идентификатор сообщения\n        + phone: 70000000000 (string) - Номер абонента\n        + user: 111 (number) - Идентификатор пользователя (только ВК)\n        + text: Text (string, required) - Текст сообщения\n        + channel: viber (string, required) - Канал\n        \n+ Response 200\n\n\n## События [/EventGarbage]\n\n### Добавление нового события [POST /EventGarbage/put]\n\n+ Request (application/json)\n\n    + Attributes (object)\n        \n        + name: New Order (string, required) - Название события\n        + data (object) - Набор параметров события\n            + field1: value 1 (string) - Параметр 1\n            + field2: value 2 (string) - Параметр 2\n            + fieldn: value n (string) - Параметр N\n\n+ Response 200 (application/json)\n\n        {\n            \"result\": \"success\"\n        }\n\n+ Response 500 (application/json)\n\n        {\n            \"result\": \"error\",\n            \"error\": \"Access denied\"\n        }"
        });
    </script>
  </body>
</html>
